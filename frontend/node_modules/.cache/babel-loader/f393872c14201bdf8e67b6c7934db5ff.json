{"ast":null,"code":"import _classCallCheck from\"C:/Users/39333/Desktop/CrowdPulse2.0-main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/39333/Desktop/CrowdPulse2.0-main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/39333/Desktop/CrowdPulse2.0-main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/39333/Desktop/CrowdPulse2.0-main/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from'react';import ReactWordcloud from'react-wordcloud';import Filters from'./Filters/WordChartFilters';import PreLoader from\"./preloader\";import stopWords from\"../stopwords.json\";import _ from\"lodash\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var WordCloud=/*#__PURE__*/function(_React$Component){_inherits(WordCloud,_React$Component);var _super=_createSuper(WordCloud);function WordCloud(props){var _this;_classCallCheck(this,WordCloud);_this=_super.call(this,props);_this.handleQuery=function(temp){_this.setState({data:temp.data});_this.state.data=temp.data;_this.state.flagWord=temp.typeWord;if(_this.state.flagWord===0||_this.state.flagWord==='0'){_this.queryText();}else if(_this.state.flagWord===1||_this.state.flagWord==='1'){_this.queryTag();}else{_this.queryHashtag();}_this.state.flag=1;_this.setState({flag:1});};_this.queryTag=function(){var i=0;var j=0;var k=0;var words=[{text:null,value:0}];var temp=null;var arrayWords=[];var flag=false;while(i<_this.state.data.length){j=0;if(_this.state.data[i].tags!==undefined){while(j<_this.state.data[i].tags.tag_me.length){temp=_this.state.data[i].tags.tag_me[j].split(' : ')[0];k=0;flag=false;while(k<arrayWords.length){if(arrayWords[k]===temp){flag=true;break;}k++;}if(flag===true){words[k].value++;}else{arrayWords.push(temp);words.push({text:temp,value:1});}j++;}}i++;}_this.state.words=words;_this.setState({words:words});_this.setState({flag:1});};_this.queryHashtag=function(){var i=0;var j=0;var k=0;var words=[{text:null,value:0}];var temp=null;var arrayWords=[];var flag=false;while(i<_this.state.data.length){j=0;if(_this.state.data[i].twitter_entities.hashtags!==undefined){while(j<_this.state.data[i].twitter_entities.hashtags.length){temp=_this.state.data[i].twitter_entities.hashtags[j];k=0;flag=false;while(k<arrayWords.length){if(arrayWords[k]===temp){flag=true;break;}k++;}if(flag===true){words[k].value++;}else{arrayWords.push(temp);words.push({text:temp,value:1});}j++;}}i++;}_this.state.words=words;_this.setState({words:words});_this.setState({flag:1});};_this.queryText=function(){var i=0;var j=0;var k=0;var words=[{text:null,value:0}];var temp=null;var arrayWords=[];var index=1;while(i<_this.state.data.length){j=0;//check spacy not null\nif(_this.state.data[i].spacy!==undefined){while(j<_this.state.data[i].spacy.processed_text.length){temp=_this.state.data[i].spacy.processed_text[j].split(\" \")[0];//check word\nif(_this.checkWord(temp)===false&&_this.state.data[i].spacy.processed_text[j].split(\" \")[3]!=='CCONJ'){//check if the word has already been counted  \nif(arrayWords[temp]===undefined){words.push({text:temp,value:1});arrayWords[temp]=index;index++;}else{try{words[arrayWords[temp]].value++;}catch(error){}}}j++;}}i++;}_this.state.words=words;_this.setState({words:words});_this.setState({flag:1});};_this.checkWord=function(temp){//check if is a character\nif(temp.length===1){return true;}//check if string is a tag \nif(temp[0]==='@'){return true;}//check if string is a number\nif(!isNaN(temp)){return true;}//chek if word is a stopword\nvar i=0;//'zr' is the last word of stopwords.json\n/*\n        while(stopWords[i]!=='zr'){\n          if(temp===stopWords[i]){\n            return true;\n          }\n          i++;\n        }\n        */ //Check if word startsm with https\nvar pattern=new RegExp('^(https?|ftp)://');if(pattern.test(temp)){return true;}//Check if word is an emoji\nvar regexExp=/(\\u00a9|\\u00ae|[\\u2000-\\u3300]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff])/gi;if(regexExp.test(temp)){return true;}return false;};_this.state={data:[],words:[{text:null,value:null}],flag:0,flagWord:0};return _this;}_createClass(WordCloud,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){if(prevProps.db!==this.props.db){this.setState({flag:0});}}},{key:\"render\",value:function render(){var _this2=this;var renderContent=function renderContent(){return/*#__PURE__*/_jsx(Filters,{parentCallback:_this2.handleQuery.bind(_this2),db:_this2.props.db,tweetsData:_this2.props.allTweetsData});};var body;var temp=renderContent();var filters;if(temp!==null){filters=temp;}else{filters=/*#__PURE__*/_jsx(PreLoader,{});}if(this.state.flag>0){body=/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12\",children:/*#__PURE__*/_jsx(\"div\",{className:\"CloudChart\",id:\"wordChart\",children:/*#__PURE__*/_jsx(ReactWordcloud,{words:this.state.words,options:{fontFamily:'monospace',rotations:1,rotationAngles:[0],fontSizes:[20,60]}})})})});}else{body=/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(\"div\",{className:\"col-lg-12\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"chart\",children:[\" \",/*#__PURE__*/_jsx(PreLoader,{})]})})});}return/*#__PURE__*/_jsxs(\"div\",{className:\"main-wrapper\",children:[/*#__PURE__*/_jsx(\"main\",{className:\"main users chart-page\",id:\"skip-target\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"h1\",{children:\"CrowdPulse\"}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsxs(\"h3\",{children:[\"Word Cloud - \",this.props.mongodb,\" \"]}),/*#__PURE__*/_jsx(\"br\",{}),filters,/*#__PURE__*/_jsx(\"br\",{}),body]})}),/*#__PURE__*/_jsx(\"footer\",{className:\"footer\",style:{background:'blue'},children:/*#__PURE__*/_jsx(\"div\",{className:\"container footer--flex\",children:/*#__PURE__*/_jsx(\"div\",{className:\"footer-start\",children:/*#__PURE__*/_jsx(\"p\",{children:\"2021 \\xA9 Giovanni Tempesta \"})})})})]});}}]);return WordCloud;}(React.Component);export default WordCloud;","map":{"version":3,"sources":["C:/Users/39333/Desktop/CrowdPulse2.0-main/frontend/src/components/WordCloud.js"],"names":["React","ReactWordcloud","Filters","PreLoader","stopWords","_","WordCloud","props","handleQuery","temp","setState","data","state","flagWord","typeWord","queryText","queryTag","queryHashtag","flag","i","j","k","words","text","value","arrayWords","length","tags","undefined","tag_me","split","push","twitter_entities","hashtags","index","spacy","processed_text","checkWord","error","isNaN","pattern","RegExp","test","regexExp","prevProps","db","renderContent","bind","allTweetsData","body","filters","fontFamily","rotations","rotationAngles","fontSizes","mongodb","background","Component"],"mappings":"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","sourcesContent":["import React from 'react';\nimport ReactWordcloud from 'react-wordcloud';\nimport Filters from './Filters/WordChartFilters'\nimport PreLoader from \"./preloader\";\nimport stopWords from \"../stopwords.json\"\nimport _ from \"lodash\"; \n\nclass WordCloud extends React.Component {\n    constructor (props) {\n        super(props)\n        this.state = {\n          data:[],\n          words:[{\n            text:null,\n            value:null\n          }],\n          flag:0,\n          flagWord:0\n\n      }\n\n    }\n    componentDidUpdate(prevProps) {\n      if(prevProps.db!==this.props.db){\n        this.setState({flag:0})\n      }\n      \n    }\n    \n  handleQuery = (temp) =>{\n\n    this.setState({data:temp.data})\n    this.state.data = temp.data\n    this.state.flagWord = temp.typeWord;\n    \n    if(this.state.flagWord===0||this.state.flagWord==='0'){\n      this.queryText();\n    }else if(this.state.flagWord===1||this.state.flagWord==='1'){\n      this.queryTag();\n    }else{\n      this.queryHashtag();\n    }\n    this.state.flag=1;\n    this.setState({flag:1});\n    \n\n\n  }\n\n  queryTag = () =>{\n\n    var i = 0\n    var j = 0\n    var k = 0\n   \n    var words=[{\n        text:null,\n        value:0\n    }]\n\n    var temp = null\n\n    var arrayWords = []\n\n    var flag = false\n\n    \n    \n    while(i<this.state.data.length){\n      j=0;\n      if(this.state.data[i].tags!==undefined){\n        \n        while(j<this.state.data[i].tags.tag_me.length){\n          \n          temp=this.state.data[i].tags.tag_me[j].split(' : ')[0]\n          k=0;\n          flag=false;\n          while(k<arrayWords.length){\n            if(arrayWords[k]===temp){\n              flag=true;\n              break\n            }\n            k++\n          }\n    \n          if(flag===true){\n            words[k].value++\n          }else{\n            arrayWords.push(temp)\n            words.push({\n              text:temp,\n              value:1\n            })            \n      \n\n            \n          }    \n          j++;\n      \n        }\n      }\n\n    i++\n    }\n    \n    \n    this.state.words=words\n    this.setState({words:words})\n    \n    this.setState({flag:1})\n    \n\n  }\n\n  queryHashtag = () =>{\n\n    var i = 0\n    var j = 0\n    var k = 0\n   \n    var words=[{\n        text:null,\n        value:0\n    }]\n\n    var temp = null;\n\n    var arrayWords = [];\n\n    var flag = false;\n\n    \n\n    \n     \n    while(i<this.state.data.length){\n      j=0;\n\n      if(this.state.data[i].twitter_entities.hashtags!==undefined){\n        \n        while(j<this.state.data[i].twitter_entities.hashtags.length){\n          \n          temp=this.state.data[i].twitter_entities.hashtags[j]\n          k=0;\n          flag=false;\n          while(k<arrayWords.length){\n            if(arrayWords[k]===temp){\n              flag=true\n              break\n            }\n            k++\n          }\n    \n          if(flag===true){\n            words[k].value++\n          }else{\n            arrayWords.push(temp)\n            words.push({\n              text:temp,\n              value:1\n            })            \n\n            \n          }    \n          j++;\n      \n        }\n      }\n     \n     i++\n     \n    }\n    \n    this.state.words=words\n    this.setState({words:words})\n    \n    this.setState({flag:1})\n\n  }\n\n\n \n      queryText = () =>{\n\n        var i = 0\n        var j = 0\n        var k = 0\n       \n        var words=[{\n            text:null,\n            value:0\n        }]\n\n        var temp = null\n\n        var arrayWords = []\n\n        \n        var index = 1;\n\n        \n\n       \n        while(i<this.state.data.length){\n          j=0;\n          //check spacy not null\n          if(this.state.data[i].spacy!==undefined){\n            while(j<this.state.data[i].spacy.processed_text.length){\n              temp=this.state.data[i].spacy.processed_text[j].split(\" \")[0];\n              //check word\n             if(this.checkWord(temp)===false&&this.state.data[i].spacy.processed_text[j].split(\" \")[3]!=='CCONJ'\n              ){\n                \n                //check if the word has already been counted  \n                if(arrayWords[temp]===undefined){\n                  words.push({\n                    text:temp,\n                    value:1\n                  })\n                  arrayWords[temp] = index;\n                  index++;\n                  \n                }else{\n                  try {\n                    words[arrayWords[temp]].value++;\n                  } catch (error) {\n                    \n                  }\n                  \n                }\n\n  \n\n                \n\n              }               \n               \n              j++;\n            }\n          }\n\n         i++\n         \n        }\n        \n        \n        this.state.words=words;\n        this.setState({words:words});\n        \n        this.setState({flag:1});\n\n      }\n   \n      checkWord = (temp) => {\n        \n        //check if is a character\n        if(temp.length===1){\n          return true;\n        }\n        //check if string is a tag \n        if(temp[0]==='@'){\n          return true\n        }\n    \n        //check if string is a number\n        if(!isNaN(temp)){         \n          return true\n        }\n\n        //chek if word is a stopword\n        var i =0;\n        //'zr' is the last word of stopwords.json\n        /*\n        while(stopWords[i]!=='zr'){\n          if(temp===stopWords[i]){\n            return true;\n          }\n          i++;\n        }\n        */\n\n        //Check if word startsm with https\n        \n        var pattern = new RegExp('^(https?|ftp)://');\n          if(pattern.test(temp)){\n          return true;\n        }\n\n        //Check if word is an emoji\n\n        const regexExp = /(\\u00a9|\\u00ae|[\\u2000-\\u3300]|\\ud83c[\\ud000-\\udfff]|\\ud83d[\\ud000-\\udfff]|\\ud83e[\\ud000-\\udfff])/gi;\n\n        if(regexExp.test(temp)){\n          return true;\n        }\n\n        return false;\n        \n      }\n    \n      render () {\n        const renderContent = () => {\n          \n           return <Filters parentCallback = {this.handleQuery.bind(this)} db = {this.props.db}  tweetsData={this.props.allTweetsData}/>;\n         \n          }\n        \n        var body;      \n        var temp = renderContent();\n        var filters;\n        \n        if(temp!==null){\n          filters=temp;\n        }else{\n          filters=<PreLoader/>\n        }\n        if(this.state.flag>0){\n          body =<div className=\"row\">\n          <div className=\"col-lg-12\">\n            <div className=\"CloudChart\" id=\"wordChart\">\n            <ReactWordcloud words={this.state.words}       options={{\n              fontFamily: 'monospace',\n              rotations: 1,\n              rotationAngles: [0],\n              fontSizes: [20, 60],\n            }} />\n            </div>\n          </div>\n\n        </div>\n        }else{\n          body=\n          <div className=\"row\">\n            <div className=\"col-lg-12\">\n            <div className=\"chart\"> <PreLoader/></div>\n          </div>\n          </div>\n        }\n          return(\n        <div className=\"main-wrapper\">\n        {/* ! Main */}\n        <main className=\"main users chart-page\" id=\"skip-target\">\n          <div className=\"container\">\n            <h1>CrowdPulse</h1>\n            <br/>\n            <h3>Word Cloud - {this.props.mongodb} </h3>\n            <br/>\n            {filters}\n            \n            <br/>\n\n            {body}\n          </div>\n        </main>\n        {/* ! Footer */}\n        <footer className=\"footer\" style={{ background: 'blue' }}>\n          <div className=\"container footer--flex\">\n            <div className=\"footer-start\">\n              <p>2021 Â© Giovanni Tempesta </p>\n            </div>\n          </div>\n        </footer>\n      </div>\n      )\n      }\n\n}\nexport default WordCloud"]},"metadata":{},"sourceType":"module"}